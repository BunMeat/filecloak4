{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Marc\\\\Desktop\\\\filecloak\\\\filecloak\\\\src\\\\pages\\\\Login.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { initializeApp } from \"firebase/app\";\nimport { getAuth, signInWithEmailAndPassword } from \"firebase/auth\";\nimport { getFirestore, doc, getDoc, updateDoc } from \"firebase/firestore\";\nimport FileCloak from '../FileCloak.webp';\nimport './Login.css';\n\n// Firebase Configuration (You should hide this using env variables)\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_APP_ID\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst firestore = getFirestore(app);\nfunction Login() {\n  _s();\n  const navigate = useNavigate();\n  const [error, setError] = useState(\"\");\n  const handleNavigation = path => {\n    navigate(path);\n  };\n  const handleSubmit = async event => {\n    event.preventDefault();\n    const email = event.target.emailLogin.value;\n    const password = event.target.passwordLogin.value;\n    const userDocRef = doc(firestore, 'users', email);\n    const userDoc = await getDoc(userDocRef);\n    const userData = userDoc.data();\n    try {\n      if (!userDoc.exists()) {\n        setError('Account not found.');\n        return;\n      }\n\n      // Check if user is blocked\n      if (userData.attemptNo >= 3) {\n        setError('User is blocked. Please contact support.');\n        return;\n      }\n\n      // Firebase Auth Sign-In\n      await signInWithEmailAndPassword(auth, email, password);\n\n      // Reset attemptNo on successful login\n      await updateDoc(userDocRef, {\n        attemptNo: 0\n      });\n\n      // Navigate based on user role\n      if (userData.role === 'user') {\n        alert('Sukses Login');\n        handleNavigation('/userpage');\n      } else if (userData.role === 'admin') {\n        alert('Sukses Login');\n        handleNavigation('/encryptfile');\n      }\n    } catch (error) {\n      // Increment attemptNo on failed login\n      if (error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {\n        const newAttemptNo = userData.attemptNo + 1;\n        await updateDoc(userDocRef, {\n          attemptNo: newAttemptNo\n        });\n        if (newAttemptNo >= 3) {\n          setError('User is blocked. Please contact support.');\n        } else {\n          setError(`Invalid password. Attempts: ${newAttemptNo}`);\n        }\n      } else if (error.code === 'auth/user-not-found') {\n        setError('Account not found.');\n      } else {\n        setError('Server error. Please try again later.');\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login-body\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-container\",\n        id: \"loginForm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"logo-container\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: FileCloak,\n            className: \"login-logo\",\n            alt: \"FileCloak\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"login-form\",\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"login-input-group\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"login-email\",\n              type: \"text\",\n              id: \"emailLogin\",\n              name: \"emailLogin\",\n              placeholder: \"Email\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"login-input-group\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"login-password\",\n              type: \"password\",\n              id: \"passwordLogin\",\n              name: \"passwordLogin\",\n              placeholder: \"Password\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"login-submit-btn\",\n            children: \"Log In\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"signup-btn-in-login\",\n            onClick: event => {\n              event.preventDefault();\n              handleNavigation('/signup');\n            },\n            children: \"Sign Up\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n_s(Login, \"jUP0uAh7TVPiOgV113kAnfFQr/s=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","useNavigate","initializeApp","getAuth","signInWithEmailAndPassword","getFirestore","doc","getDoc","updateDoc","FileCloak","jsxDEV","_jsxDEV","Fragment","_Fragment","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","projectId","REACT_APP_PROJECT_ID","storageBucket","REACT_APP_STORAGE_BUCKET","messagingSenderId","REACT_APP_MESSAGING_SENDER_ID","appId","REACT_APP_APP_ID","app","auth","firestore","Login","_s","navigate","error","setError","handleNavigation","path","handleSubmit","event","preventDefault","email","target","emailLogin","value","password","passwordLogin","userDocRef","userDoc","userData","data","exists","attemptNo","role","alert","code","newAttemptNo","children","className","id","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","placeholder","required","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Marc/Desktop/filecloak/filecloak/src/pages/Login.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getAuth, signInWithEmailAndPassword } from \"firebase/auth\";\r\nimport { getFirestore, doc, getDoc, updateDoc } from \"firebase/firestore\";\r\nimport FileCloak from '../FileCloak.webp';\r\nimport './Login.css';\r\n\r\n// Firebase Configuration (You should hide this using env variables)\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.REACT_APP_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_APP_ID,\r\n};\r\n\r\n// Initialize Firebase\r\nconst app = initializeApp(firebaseConfig);\r\nconst auth = getAuth(app);\r\nconst firestore = getFirestore(app);\r\n\r\nfunction Login() {\r\n  const navigate = useNavigate();\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const handleNavigation = (path) => {\r\n    navigate(path);\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    const email = event.target.emailLogin.value;\r\n    const password = event.target.passwordLogin.value;\r\n    const userDocRef = doc(firestore, 'users', email);\r\n    const userDoc = await getDoc(userDocRef);\r\n    const userData = userDoc.data();\r\n    try {\r\n\r\n      if (!userDoc.exists()) {\r\n        setError('Account not found.');\r\n        return;\r\n      }\r\n\r\n      // Check if user is blocked\r\n      if (userData.attemptNo >= 3) {\r\n        setError('User is blocked. Please contact support.');\r\n        return;\r\n      }\r\n\r\n      // Firebase Auth Sign-In\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n\r\n      // Reset attemptNo on successful login\r\n      await updateDoc(userDocRef, { attemptNo: 0 })\r\n\r\n      // Navigate based on user role\r\n      if (userData.role === 'user') {\r\n        alert('Sukses Login');\r\n        handleNavigation('/userpage');\r\n      } else if (userData.role === 'admin') {\r\n        alert('Sukses Login');\r\n        handleNavigation('/encryptfile');\r\n      }\r\n    } catch (error) {\r\n      // Increment attemptNo on failed login\r\n      if (error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {\r\n        const newAttemptNo = userData.attemptNo + 1;\r\n        await updateDoc(userDocRef, { attemptNo: newAttemptNo });\r\n\r\n        if (newAttemptNo >= 3) {\r\n          setError('User is blocked. Please contact support.');\r\n        } else {\r\n          setError(`Invalid password. Attempts: ${newAttemptNo}`);\r\n        }\r\n      } else if (error.code === 'auth/user-not-found') {\r\n        setError('Account not found.');\r\n      } else {\r\n        setError('Server error. Please try again later.');\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"login-body\">\r\n        <div className=\"login-container\" id=\"loginForm\">\r\n          <div className=\"logo-container\">\r\n            <img src={FileCloak} className=\"login-logo\" alt=\"FileCloak\" />\r\n          </div>\r\n          <form className=\"login-form\" onSubmit={handleSubmit}>\r\n            <div className=\"login-input-group\">\r\n              <input\r\n                className=\"login-email\"\r\n                type=\"text\"\r\n                id=\"emailLogin\"\r\n                name=\"emailLogin\"\r\n                placeholder=\"Email\"\r\n                required\r\n              />\r\n            </div>\r\n            <div className=\"login-input-group\">\r\n              <input\r\n                className=\"login-password\"\r\n                type=\"password\"\r\n                id=\"passwordLogin\"\r\n                name=\"passwordLogin\"\r\n                placeholder=\"Password\"\r\n                required\r\n              />\r\n            </div>\r\n            <button type=\"submit\" className=\"login-submit-btn\">\r\n              Log In\r\n            </button>\r\n            <button\r\n              className=\"signup-btn-in-login\"\r\n              onClick={(event) => {\r\n                event.preventDefault();\r\n                handleNavigation('/signup');\r\n              }}\r\n            >\r\n              Sign Up\r\n            </button>\r\n          </form>\r\n          {error && <p className=\"error-message\">{error}</p>}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}